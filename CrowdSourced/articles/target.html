
  <head>
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <title>target</title>
    <link rel="stylesheet" type="text/css" href="./articles/target/target.css" />
    <!--[if IE]><script type="text/javascript" src="./target/excanvas-compiled.js"></script><![endif]-->
    <script type="text/javascript" src="./articles/target/target.js"> </script>
  </head>
  <body>
    <div style="margin:1ex;">
      <div style="width:100%">
        <table style="border:0;width:100%;">
          <tbody>
            <tr>
              <td bgcolor="eeeeee" align="right">
                <font face="arial,sans-serif">
                  <b>Page 1</b>
                </font>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <div style="position:relative;width:612pt;height:792pt;">
        <div style="position:absolute;left:0pt;top:0pt;width:100%;height:100%;clip:rect(0pt,612pt,792pt,0pt);" class="fmt-1"><span class="fmt-0" style="white-space:pre;"><div style="position:absolute;top:73.962pt;left:72pt;z-index:53;letter-spacing:-.011em;">Finding the Closest Pair of Points: A Randomized Approach</div></span><span style="white-space:pre;"><div style="position:absolute;top:122.73pt;left:72pt;z-index:143;letter-spacing:-.008em;">In this article, we will show how to use randomization to develop an algorithm for the closest pair problem,</div></span><span style="white-space:pre;"><div style="position:absolute;top:137.73pt;left:72pt;z-index:234;letter-spacing:-.006em;">using an underlying dictionary data structure. We will show that this algorithm runs in O(n) expected time,</div></span><span style="white-space:pre;"><div style="position:absolute;top:152.73pt;left:72pt;z-index:271;letter-spacing:-.008em;">plus O(n) expected dictionary operations.</div></span><span style="white-space:pre;"><div style="position:absolute;top:182.73pt;left:72pt;z-index:360;letter-spacing:-.008em;">There are several related reasons why it is useful to express the running time of our algorithm in this way,</div></span><span style="white-space:pre;"><div style="position:absolute;top:197.73pt;left:72pt;z-index:447;letter-spacing:.007em;">accounting  for  the  dictionary  operations separately. We know that dictionaries have a very efficient</div></span><span style="white-space:pre;"><div style="position:absolute;top:212.73pt;left:72pt;z-index:540;letter-spacing:-.005em;">implementation using hashing, so abstracting out the dictionary operations allows us to treat the hashing as</div></span><span style="white-space:pre;"><div style="position:absolute;top:227.73pt;left:72pt;z-index:629;letter-spacing:-.009em;">a "black box" and have the algorithm inherit an overall running time from whatever performance guarantee</div></span><span style="white-space:pre;"><div style="position:absolute;top:242.73pt;left:72pt;z-index:717;letter-spacing:.002em;">is satisfied by this hashing procedure. A concrete payoff of this is the following. It has been shown that</div></span><span style="white-space:pre;"><div style="position:absolute;top:257.73pt;left:72pt;z-index:808;letter-spacing:-.007em;">with the right choice of hashing procedure, one can make the underlying dictionary operations run in linear</div></span><span style="white-space:pre;"><div style="position:absolute;top:272.73pt;left:72pt;z-index:897;letter-spacing:-.006em;">expected time as well, yielding an overall expected running time of O(n). We will talk about the ideas that</div></span><span style="white-space:pre;"><div style="position:absolute;top:287.73pt;left:72pt;z-index:938;letter-spacing:-.016em;">lead to this O(n) bound at the end of this section.</div></span><span style="white-space:pre;"><div style="position:absolute;top:317.73pt;left:72pt;z-index:1021;letter-spacing:.021em;">It is worth remarking at the outset that randomization shows up for two independent reasons in this</div></span><span style="white-space:pre;"><div style="position:absolute;top:332.73pt;left:72pt;z-index:1104;letter-spacing:.019em;">algorithm: the way in which the algorithm processes the input points will have a random component,</div></span><span style="white-space:pre;"><div style="position:absolute;top:347.73pt;left:72pt;z-index:1192;letter-spacing:-.011em;">regardless of how the dictionary data structure is implemented; and when the dictionary is implemented</div></span><span style="white-space:pre;"><div style="position:absolute;top:362.73pt;left:72pt;z-index:1281;letter-spacing:.011em;">using hashing, this introduces an additional source of randomness as part of the hash­table operations.</div></span><span style="white-space:pre;"><div style="position:absolute;top:377.73pt;left:72pt;z-index:1370;letter-spacing:-.003em;">Expressing the running time via the number of dictionary operations allows us to cleanly separate the two</div></span><span style="white-space:pre;"><div style="position:absolute;top:392.73pt;left:72pt;z-index:1387;letter-spacing:-.009em;">uses of randomness.</div></span><span class="fmt-2" style="white-space:pre;"><div style="position:absolute;top:422.3pt;left:72pt;z-index:1397;letter-spacing:-.007em;">The Problem</div></span><span style="white-space:pre;"><div style="position:absolute;top:442.23pt;left:72pt;z-index:1483;letter-spacing:-.007em;">We are given n points in the plane, and we wish to find the pair that is closest together. This is one of the</div></span><span style="white-space:pre;"><div style="position:absolute;top:457.23pt;left:72pt;z-index:1554;letter-spacing:-.012em;">most basic geometric <span class="fmt-3">p</span><span class="fmt-3">r</span><span class="fmt-3">o</span><span class="fmt-3">x</span><span class="fmt-3">i</span><span class="fmt-3">m</span><span class="fmt-3">i</span><span class="fmt-3">t</span><span class="fmt-3">y</span> problems, a topic with a wide range of applications.</div></span><span style="white-space:pre;"><div style="position:absolute;top:487.23pt;left:72pt;z-index:1642;letter-spacing:-.003em;">We will use the same notation as in our earlier discussion of the closest­pair problem. We will denote the</div></span><span style="white-space:pre;"><div style="position:absolute;top:502.98pt;left:72pt;z-index:1726;letter-spacing:-.016em;">set of points by P = { <span class="fmt-3">p</span><span class="fmt-4" style="position:relative;left:0pt;top:3pt;">1</span> ..... <span class="fmt-3">p</span><span class="fmt-4" style="position:relative;left:0pt;top:3pt;">n</span>}, where <span class="fmt-5">p</span><span class="fmt-6" style="position:relative;left:0pt;top:3pt;">i</span> has coordinates (<span class="fmt-5">x</span><span class="fmt-7" style="position:relative;left:0pt;top:3pt;">i</span> <span class="fmt-5">,</span> <span class="fmt-5">y</span><span class="fmt-7" style="position:relative;left:0pt;top:3pt;">i</span>); and for two points <span class="fmt-3">p</span><span class="fmt-8" style="position:relative;left:0pt;top:3pt;">i</span><span class="fmt-3">,</span> <span class="fmt-3">p</span><span class="fmt-8" style="position:relative;left:0pt;top:3pt;">j</span> <span class="fmt-9">∈</span> P, we use</div></span><span style="white-space:pre;"><div style="position:absolute;top:518.73pt;left:72pt;z-index:1815;letter-spacing:-.006em;"><span class="fmt-3">d</span>(<span class="fmt-3">p</span><span class="fmt-8" style="position:relative;left:0pt;top:3pt;">i</span><span class="fmt-3">,</span> <span class="fmt-3">p</span><span class="fmt-8" style="position:relative;left:0pt;top:3pt;">j</span>) to denote the standard Euclidean distance between them. Our goal is to find the pair of points <span class="fmt-3">p</span><span class="fmt-8" style="position:relative;left:0pt;top:3pt;">i</span><span class="fmt-3">,</span></div></span><span style="white-space:pre;"><div style="position:absolute;top:533.73pt;left:72pt;z-index:1839;letter-spacing:-.006em;"><span class="fmt-3">p</span><span class="fmt-8" style="position:relative;left:0pt;top:3pt;">j</span> that minimizes <span class="fmt-3">d</span>(<span class="fmt-3">p</span><span class="fmt-8" style="position:relative;left:0pt;top:3pt;">i</span><span class="fmt-3">,</span> <span class="fmt-3">p</span><span class="fmt-8" style="position:relative;left:0pt;top:3pt;">j</span>).</div></span><span style="white-space:pre;"><div style="position:absolute;top:563.73pt;left:72pt;z-index:1927;letter-spacing:-.008em;">To simplify the discussion, we will assume that the points are all in the unit square: 0 ≤ xi, yi &lt; 1 for all i =</div></span><span style="white-space:pre;"><div style="position:absolute;top:578.73pt;left:72pt;z-index:2016;letter-spacing:.006em;">1, ..... ,n. This is no loss of generality: in linear time, we can rescale all the x­ and y­coordinates of the</div></span><span style="white-space:pre;"><div style="position:absolute;top:593.73pt;left:72pt;z-index:2105;letter-spacing:-.01em;">points so that they lie in a unit square, and then we can translate them so that this unit square has its lower</div></span><span style="white-space:pre;"><div style="position:absolute;top:608.73pt;left:72pt;z-index:2128;letter-spacing:-.012em;">left corner: at the origin.</div></span><span class="fmt-2" style="white-space:pre;"><div style="position:absolute;top:638.3pt;left:72pt;z-index:2149;letter-spacing:-.007em;">Designing the Algorithm</div></span><span style="white-space:pre;"><div style="position:absolute;top:658.23pt;left:72pt;z-index:2236;">The basic idea of the algorithm is very simple. We’ll consider the points in random order, and maintain a</div></span><span style="white-space:pre;"><div style="position:absolute;top:673.23pt;left:72pt;z-index:2320;letter-spacing:-.005em;">current value δ for the closest pair as we process the points in this order. When we get to a new point <span class="fmt-3">p</span>,</div></span><span style="white-space:pre;"><div style="position:absolute;top:688.23pt;left:72pt;z-index:2408;letter-spacing:-.007em;">we look "in the vicinity" of <span class="fmt-3">p</span> to see if any of the previously considered points are at a distance less than δ</div></span><canvas id="_canv_1" style="position:absolute;left:0pt;top:0pt;width:612pt;height:792pt;z-index:1;" width="816" height="1056">Your browser does not support the canvas tag!</canvas><canvas id="_canv_2" style="position:absolute;left:0pt;top:0pt;width:612pt;height:7920pt;z-index:2;" width="816" height="10560">Your browser does not support the canvas tag!</canvas><canvas id="_canv_3" style="position:absolute;left:0pt;top:0pt;width:612pt;height:792pt;z-index:3;" width="816" height="1056">Your browser does not support the canvas tag!</canvas><canvas id="_canv_4" style="position:absolute;left:0pt;top:72pt;width:612pt;height:720pt;z-index:4;" width="816" height="960">Your browser does not support the canvas tag!</canvas><span style="white-space:pre;"><div style="position:absolute;top:703.23pt;left:72pt;z-index:2494;letter-spacing:-.011em;">from p. If not, then the closest pair hasn’t changed, and we move on to the next point in the random order.</div></span></div>
      </div>
      <script type="text/javascript">DrawPage1();</script>
      <div style="width:100%">
        <hr />
        <table style="border:0;width:100%;">
          <tbody>
            <tr>
              <td bgcolor="eeeeee" align="right">
                <font face="arial,sans-serif">
                  <b>Page 2</b>
                </font>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <div style="position:relative;width:612pt;height:792pt;">
        <div style="position:absolute;left:0pt;top:0pt;width:100%;height:100%;clip:rect(0pt,612pt,792pt,0pt);" class="fmt-1"><span style="white-space:pre;"><div style="position:absolute;top:73.2263pt;left:72pt;z-index:91;letter-spacing:-.01em;">If there is a point within a distance less than δ from <span class="fmt-3">p</span>, then the closest pair has changed, and we will need</div></span><span style="white-space:pre;"><div style="position:absolute;top:88.2263pt;left:72pt;z-index:102;letter-spacing:-.012em;">to update it.</div></span><span style="white-space:pre;"><div style="position:absolute;top:118.23pt;left:72pt;z-index:194;letter-spacing:-.011em;">The challenge in turning this into an efficient algorithm is to figure out how to implement the task of looking</div></span><span style="white-space:pre;"><div style="position:absolute;top:133.23pt;left:72pt;z-index:276;letter-spacing:-.015em;">for points in the vicinity of <span class="fmt-3">p</span>. It is here that the dictionary, data structure will come into play.</div></span><span style="white-space:pre;"><div style="position:absolute;top:163.23pt;left:72pt;z-index:362;letter-spacing:-.01em;">We now begin making this more concrete. Let us assume for simplicity that the points in our random order</div></span><span style="white-space:pre;"><div style="position:absolute;top:178.23pt;left:72pt;z-index:448;letter-spacing:.009em;">are labeled <span class="fmt-3">p</span><span class="fmt-8" style="position:relative;left:0pt;top:3pt;">1</span><span class="fmt-3">,</span> <span class="fmt-3">.</span> <span class="fmt-3">.</span> <span class="fmt-3">.</span> <span class="fmt-3">,</span> <span class="fmt-3">p</span><span class="fmt-8" style="position:relative;left:0pt;top:3pt;">n</span>. The algorithm proceeds in stages; during each stage, the closest pair remains</div></span><span style="white-space:pre;"><div style="position:absolute;top:193.23pt;left:72pt;z-index:537;letter-spacing:-.005em;">constant. The first stage starts by setting δ = <span class="fmt-3">d</span>(<span class="fmt-3">p</span><span class="fmt-8" style="position:relative;left:0pt;top:3pt;">l</span> <span class="fmt-3">,</span> <span class="fmt-3">p</span><span class="fmt-8" style="position:relative;left:0pt;top:3pt;">2</span>), the distance of the first two points. The goal of a</div></span><span style="white-space:pre;"><div style="position:absolute;top:208.23pt;left:72pt;z-index:628;letter-spacing:-.007em;">stage is to either verify that δ is indeed the distance of the closest pair of points, or to find a pair of points</div></span><span style="white-space:pre;"><div style="position:absolute;top:223.23pt;left:72pt;z-index:715;letter-spacing:-.002em;"><span class="fmt-3">p</span><span class="fmt-8" style="position:relative;left:0pt;top:3pt;">i</span>, <span class="fmt-3">p</span><span class="fmt-8" style="position:relative;left:0pt;top:3pt;">j</span> with <span class="fmt-3">d</span>(<span class="fmt-3">p</span><span class="fmt-8" style="position:relative;left:0pt;top:3pt;">i</span>, <span class="fmt-3">p</span><span class="fmt-8" style="position:relative;left:0pt;top:3pt;">j</span>) &lt; δ. During a stage, we’ll gradually add points in the order <span class="fmt-3">p</span><span class="fmt-8" style="position:relative;left:0pt;top:3pt;">1</span>, <span class="fmt-3">p</span><span class="fmt-8" style="position:relative;left:0pt;top:3pt;">2</span>, . . . ,<span class="fmt-3">p</span><span class="fmt-8" style="position:relative;left:0pt;top:3pt;">n</span>. The stage</div></span><span style="white-space:pre;"><div style="position:absolute;top:238.23pt;left:72pt;z-index:794;letter-spacing:-.002em;">terminates when we reach a point <span class="fmt-3">p</span><span class="fmt-8" style="position:relative;left:0pt;top:3pt;">i</span> so that for some <span class="fmt-3">j</span> &lt; <span class="fmt-3">i</span>, we have <span class="fmt-3">d</span>(<span class="fmt-3">p</span><span class="fmt-8" style="position:relative;left:0pt;top:3pt;">i</span>, <span class="fmt-3">p</span><span class="fmt-8" style="position:relative;left:0pt;top:3pt;">j</span>) &lt; δ. We then let δ for the</div></span><span style="white-space:pre;"><div style="position:absolute;top:253.98pt;left:72pt;z-index:853;letter-spacing:-.015em;">next stage be the closest distance found so far: δ = min<span class="fmt-6" style="position:relative;left:0pt;top:3pt;">j</span><span class="fmt-6" style="position:relative;left:0pt;top:3pt;">:</span><span class="fmt-6" style="position:relative;left:0pt;top:3pt;">j</span><span class="fmt-6" style="position:relative;left:0pt;top:3pt;">&lt;</span><span class="fmt-6" style="position:relative;left:0pt;top:3pt;">i</span> <span class="fmt-3">d</span>(<span class="fmt-3">p</span><span class="fmt-8" style="position:relative;left:0pt;top:3pt;">i</span>, <span class="fmt-3">p</span><span class="fmt-8" style="position:relative;left:0pt;top:3pt;">j</span>).</div></span><span style="white-space:pre;"><div style="position:absolute;top:284.73pt;left:72pt;z-index:935;letter-spacing:.004em;">The number of stages used will depend on the random order. If we get lucky, and p<span class="fmt-4" style="position:relative;left:0pt;top:3pt;">l</span>, p<span class="fmt-4" style="position:relative;left:0pt;top:3pt;">2</span> are the closest</div></span><span style="white-space:pre;"><div style="position:absolute;top:299.73pt;left:72pt;z-index:1020;letter-spacing:.002em;">pair of points, then a single stage will do. It is also possible to have as many as n ­ 2 stages, if adding a</div></span><span style="white-space:pre;"><div style="position:absolute;top:314.73pt;left:72pt;z-index:1102;letter-spacing:.013em;">new point always decreases the minimum distance. We’ll show that the expected running time of the</div></span><span style="white-space:pre;"><div style="position:absolute;top:329.73pt;left:72pt;z-index:1193;letter-spacing:-.011em;">algorithm is within a constant factor of the time needed in the first, lucky case, when the original value of δ</div></span><span style="white-space:pre;"><div style="position:absolute;top:344.73pt;left:72pt;z-index:1215;letter-spacing:-.01em;">is the smallest distance.</div></span><span style="white-space:pre;"><div style="position:absolute;top:374.73pt;left:72pt;z-index:1296;letter-spacing:.011em;"><span class="fmt-10">T</span><span class="fmt-10">e</span><span class="fmt-10">s</span><span class="fmt-10">t</span><span class="fmt-10">i</span><span class="fmt-10">n</span><span class="fmt-10">g</span> <span class="fmt-10">a</span> <span class="fmt-10">P</span><span class="fmt-10">r</span><span class="fmt-10">o</span><span class="fmt-10">p</span><span class="fmt-10">o</span><span class="fmt-10">s</span><span class="fmt-10">e</span><span class="fmt-10">d</span> <span class="fmt-10">D</span><span class="fmt-10">i</span><span class="fmt-10">s</span><span class="fmt-10">t</span><span class="fmt-10">a</span><span class="fmt-10">n</span><span class="fmt-10">c</span><span class="fmt-10">e</span><span class="fmt-10">:</span>  The main subroutine of the algorithm is a method to test whether the</div></span><span style="white-space:pre;"><div style="position:absolute;top:389.73pt;left:72pt;z-index:1385;letter-spacing:-.011em;">current pair of points with distance δ remains the closest pair when a new point is added and, if not, to find</div></span><span style="white-space:pre;"><div style="position:absolute;top:404.73pt;left:72pt;z-index:1403;letter-spacing:-.012em;">the new closest pair.</div></span><span style="white-space:pre;"><div style="position:absolute;top:434.73pt;left:72pt;z-index:1494;letter-spacing:-.003em;">The idea of the verification is to subdivide the unit square (the area where the points lie) into subsquares,</div></span><span style="white-space:pre;"><div style="position:absolute;top:449.73pt;left:72pt;z-index:1578;letter-spacing:.002em;">whose sides have length δ/2, as shown in Figure 13.2. Formally, there will be N<span class="fmt-4" style="position:relative;left:0pt;top:-4pt;">2</span> subsquares, where N=</div></span><span style="white-space:pre;"><div style="position:absolute;top:464.73pt;left:72pt;z-index:1627;letter-spacing:-.026em;">1/(2δ): for 0  s  N ­ 1 and 1  t  N ­ 1, we define the subsquare S<span class="fmt-4" style="position:relative;left:0pt;top:3pt;">s</span><span class="fmt-4" style="position:relative;left:0pt;top:3pt;">t</span> as</div></span><span style="white-space:pre;"><div style="position:absolute;top:494.73pt;left:72pt;z-index:1671;letter-spacing:-.019em;">S<span class="fmt-4" style="position:relative;left:0pt;top:3pt;">s</span><span class="fmt-4" style="position:relative;left:0pt;top:3pt;">t</span> = {(x, y) : sδ/2 ≤ x &lt; (s + 1)δ/2; tδ/2≤ y &lt; (t + 1)δ/2}.</div></span><span style="white-space:pre;"><div style="position:absolute;top:524.73pt;left:72pt;z-index:1761;letter-spacing:-.005em;">We claim that this collection of subsquares has two nice properties for our purposes. First, any two points</div></span><span style="white-space:pre;"><div style="position:absolute;top:539.73pt;left:72pt;z-index:1847;letter-spacing:.002em;">that lie in the same subsquare have distance less than δ. Second, and a partial converse to this, any two</div></span><span style="white-space:pre;"><div style="position:absolute;top:554.73pt;left:72pt;z-index:1931;letter-spacing:.002em;">points that are less than δ away from each other must fall in either the same subsquare or in very close</div></span><canvas id="_canv_5" style="position:absolute;left:0pt;top:0pt;width:612pt;height:792pt;z-index:1;" width="816" height="1056">Your browser does not support the canvas tag!</canvas><canvas id="_canv_6" style="position:absolute;left:0pt;top:-792pt;width:612pt;height:7920pt;z-index:2;" width="816" height="10560">Your browser does not support the canvas tag!</canvas><canvas id="_canv_7" style="position:absolute;left:0pt;top:0pt;width:612pt;height:792pt;z-index:3;" width="816" height="1056">Your browser does not support the canvas tag!</canvas><canvas id="_canv_8" style="position:absolute;left:0pt;top:72pt;width:612pt;height:720pt;z-index:4;" width="816" height="960">Your browser does not support the canvas tag!</canvas><span style="white-space:pre;"><div style="position:absolute;top:569.73pt;left:72pt;z-index:1942;">subsquares.</div></span></div>
      </div>
      <script type="text/javascript">DrawPage2();</script>
      <div style="width:100%">
        <hr />
        <table style="border:0;width:100%;">
          <tbody>
            <tr>
              <td bgcolor="eeeeee" align="right">
                <font face="arial,sans-serif">
                  <b>Page 3</b>
                </font>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <div style="position:relative;width:612pt;height:792pt;">
        <div style="position:absolute;left:0pt;top:0pt;width:100%;height:100%;clip:rect(0pt,612pt,792pt,0pt);" class="fmt-1">
          <img style="position:absolute;left:73.5pt;top:73.5pt;width:468pt;height:263.25pt;z-index:5;" src="./articles/target/284a174621b3e75ae2417198c0b51cf9.png" alt="Image_7_0" /><span style="white-space:pre;"><div style="position:absolute;top:357.48pt;left:72pt;z-index:85;letter-spacing:-.014em;">Figure 13.2 Dividing the square into size  δ/2 subsquares. The point <span class="fmt-3">p</span> lies in the subsquare S<span class="fmt-4" style="position:relative;left:0pt;top:3pt;">s</span><span class="fmt-4" style="position:relative;left:0pt;top:3pt;">t</span><span class="fmt-4" style="position:relative;left:0pt;top:3pt;">.</span></div></span><span class="fmt-3" style="white-space:pre;"><div style="position:absolute;top:402.48pt;left:72pt;z-index:149;letter-spacing:-.015em;"><span class="fmt-11">(</span><span class="fmt-11">1</span><span class="fmt-11">3</span><span class="fmt-11">.</span><span class="fmt-11">2</span><span class="fmt-11">6</span><span class="fmt-11">)</span> If two points p and q belong to the same subsquare S<span class="fmt-8" style="position:relative;left:0pt;top:3pt;">s</span><span class="fmt-8" style="position:relative;left:0pt;top:3pt;">t</span> , then d(p,q) &lt; <span class="fmt-1">δ</span>.</div></span><span style="white-space:pre;"><div style="position:absolute;top:432.48pt;left:72pt;z-index:233;letter-spacing:.003em;"><span class="fmt-11">P</span><span class="fmt-11">r</span><span class="fmt-11">o</span><span class="fmt-11">o</span><span class="fmt-11">f</span>. If points <span class="fmt-3">p</span> and <span class="fmt-3">q</span> are in the same subsquare, then both coordinates of the two points differ by at</div></span><canvas id="_canv_9" style="position:absolute;left:219.75pt;top:447.75pt;width:64.5pt;height:1pt;z-index:271;" width="86" height="1.3333">Your browser does not support the canvas tag!</canvas><span style="white-space:pre;"><div style="position:absolute;top:452.73pt;left:72pt;z-index:291;letter-spacing:-.016em;">most δ/2, and hence <span class="fmt-3">d</span>(<span class="fmt-3">p</span>, <span class="fmt-3">q</span>) ≤ <span class="fmt-13" style="position:relative;left:0pt;top:5pt;">√</span><span class="fmt-12">(</span><span class="fmt-12">δ</span><span class="fmt-12">/</span><span class="fmt-12">2</span><span class="fmt-12">)</span><span class="fmt-14" style="position:relative;left:0pt;top:-4pt;">2</span> <span class="fmt-12">+</span> <span class="fmt-12">(</span><span class="fmt-12">δ</span><span class="fmt-12">/</span><span class="fmt-12">2</span><span class="fmt-12">)</span><span class="fmt-14" style="position:relative;left:0pt;top:-4pt;">2</span> <span class="fmt-12">=</span> <span class="fmt-12">δ</span><span class="fmt-12">/</span><span class="fmt-12">√</span><span class="fmt-12">2</span> <span class="fmt-12">&lt;</span> <span class="fmt-12">δ</span><span class="fmt-12">,</span>as required.</div></span><canvas id="_canv_10" style="position:absolute;left:311.25pt;top:453pt;width:5.25pt;height:1pt;z-index:288;" width="7" height="1.3333">Your browser does not support the canvas tag!</canvas><span style="white-space:pre;"><div style="position:absolute;top:486.48pt;left:72pt;z-index:378;letter-spacing:-.013em;">Next, we say that subsquares S<span class="fmt-4" style="position:relative;left:0pt;top:3pt;">s</span><span class="fmt-4" style="position:relative;left:0pt;top:3pt;">t</span> and S<span class="fmt-4" style="position:relative;left:0pt;top:3pt;">s</span><span class="fmt-4" style="position:relative;left:0pt;top:3pt;">’</span><span class="fmt-4" style="position:relative;left:0pt;top:3pt;">t</span><span class="fmt-4" style="position:relative;left:0pt;top:3pt;">’</span>, are <span class="fmt-3">c</span><span class="fmt-3">l</span><span class="fmt-3">o</span><span class="fmt-3">s</span><span class="fmt-3">e</span> if <span class="fmt-12">|</span><span class="fmt-15">s</span> <span class="fmt-12">−</span> <span class="fmt-15">s</span><span class="fmt-16">′</span><span class="fmt-12">|</span> ≤ 2 and <span class="fmt-12">|</span><span class="fmt-15">t</span> <span class="fmt-12">−</span> <span class="fmt-15">t</span><span class="fmt-16">′</span><span class="fmt-12">|</span> ≤ 2. (Note that a subsquare is</div></span><span style="white-space:pre;"><div style="position:absolute;top:502.98pt;left:72pt;z-index:393;letter-spacing:-.009em;">close to itself.)</div></span><span class="fmt-3" style="white-space:pre;"><div style="position:absolute;top:532.98pt;left:72pt;z-index:468;letter-spacing:.004em;"><span class="fmt-11">(</span><span class="fmt-11">1</span><span class="fmt-11">3</span><span class="fmt-11">.</span><span class="fmt-11">2</span><span class="fmt-11">7</span><span class="fmt-11">)</span> If for two points p, q <span class="fmt-17">∈</span> P we have d(p, q) &lt; <span class="fmt-1">δ</span><span class="fmt-1">,</span> then the subsquares containing them are</div></span><span class="fmt-3" style="white-space:pre;"><div style="position:absolute;top:547.98pt;left:72pt;z-index:474;">close.</div></span><span style="white-space:pre;"><div style="position:absolute;top:577.98pt;left:72pt;z-index:555;letter-spacing:-.019em;"><span class="fmt-11">P</span><span class="fmt-11">r</span><span class="fmt-11">o</span><span class="fmt-11">o</span><span class="fmt-11">f</span><span class="fmt-11">.</span> Consider two points p, q <span class="fmt-9">∈</span> P belonging to subsquares that are not close; assume p <span class="fmt-9">∈</span> S<span class="fmt-4" style="position:relative;left:0pt;top:3pt;">s</span><span class="fmt-4" style="position:relative;left:0pt;top:3pt;">t</span> and q <span class="fmt-9">∈</span></div></span><span style="white-space:pre;"><div style="position:absolute;top:592.98pt;left:72pt;z-index:639;letter-spacing:.013em;">S<span class="fmt-4" style="position:relative;left:0pt;top:3pt;">s</span><span class="fmt-4" style="position:relative;left:0pt;top:3pt;">’</span><span class="fmt-4" style="position:relative;left:0pt;top:3pt;">t</span><span class="fmt-4" style="position:relative;left:0pt;top:3pt;">’</span> ,where one of s, s’ or t, t’ differs by more than 2. It follows that in one of their respective x­ or</div></span><span style="white-space:pre;"><div style="position:absolute;top:607.98pt;left:72pt;z-index:701;letter-spacing:-.018em;">y­coordinates, p and q differ by at least δ, and so we cannot have d(<span class="fmt-3">p</span>, <span class="fmt-3">q</span>) &lt; δ.</div></span><span style="white-space:pre;"><div style="position:absolute;top:637.98pt;left:72pt;z-index:781;letter-spacing:.01em;">Note that for any subsquare S<span class="fmt-4" style="position:relative;left:0pt;top:3pt;">s</span><span class="fmt-4" style="position:relative;left:0pt;top:3pt;">t</span>, the set of subsquares dose to it form a 5 x 5 grid around it. Thus we</div></span><span style="white-space:pre;"><div style="position:absolute;top:652.98pt;left:72pt;z-index:871;letter-spacing:-.009em;">conclude that there are at most 25 subsquares close to S<span class="fmt-4" style="position:relative;left:0pt;top:3pt;">s</span><span class="fmt-4" style="position:relative;left:0pt;top:3pt;">t</span>, counting S<span class="fmt-4" style="position:relative;left:0pt;top:3pt;">s</span><span class="fmt-4" style="position:relative;left:0pt;top:3pt;">t</span> itself. (There will be fewer than 25</div></span><canvas id="_canv_11" style="position:absolute;left:0pt;top:0pt;width:612pt;height:792pt;z-index:1;" width="816" height="1056">Your browser does not support the canvas tag!</canvas><canvas id="_canv_12" style="position:absolute;left:0pt;top:-1584pt;width:612pt;height:7920pt;z-index:2;" width="816" height="10560">Your browser does not support the canvas tag!</canvas><canvas id="_canv_13" style="position:absolute;left:0pt;top:0pt;width:612pt;height:792pt;z-index:3;" width="816" height="1056">Your browser does not support the canvas tag!</canvas><canvas id="_canv_14" style="position:absolute;left:0pt;top:72pt;width:612pt;height:720pt;z-index:4;" width="816" height="960">Your browser does not support the canvas tag!</canvas><span style="white-space:pre;"><div style="position:absolute;top:667.98pt;left:72pt;z-index:928;letter-spacing:-.012em;">if S<span class="fmt-4" style="position:relative;left:0pt;top:3pt;">s</span><span class="fmt-4" style="position:relative;left:0pt;top:3pt;">t</span>is at the edge of the unit square containing the input points.)</div></span></div>
      </div>
      <script type="text/javascript">DrawPage3();</script>
      <div style="width:100%">
        <hr />
        <table style="border:0;width:100%;">
          <tbody>
            <tr>
              <td bgcolor="eeeeee" align="right">
                <font face="arial,sans-serif">
                  <b>Page 4</b>
                </font>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <div style="position:relative;width:612pt;height:792pt;">
        <div style="position:absolute;left:0pt;top:0pt;width:100%;height:100%;clip:rect(0pt,612pt,792pt,0pt);" class="fmt-1"><span style="white-space:pre;"><div style="position:absolute;top:73.2263pt;left:72pt;z-index:93;letter-spacing:.001em;">Statements (13.26) and (13.27) suggest the basic outline of our algorithm. Suppose that, at some point in</div></span><span style="white-space:pre;"><div style="position:absolute;top:88.2263pt;left:72pt;z-index:175;letter-spacing:-.007em;">the algorithm, we have proceeded partway through the random order of the points and seen P’ <span class="fmt-9">⊆</span> P, and</div></span><span style="white-space:pre;"><div style="position:absolute;top:103.23pt;left:72pt;z-index:253;letter-spacing:.006em;">suppose that we know the minimum distance among pomts in to be 3. For each of the points in P’, we</div></span><span style="white-space:pre;"><div style="position:absolute;top:118.23pt;left:72pt;z-index:289;letter-spacing:-.012em;">keep track of the subsquare containing it.</div></span><span style="white-space:pre;"><div style="position:absolute;top:148.23pt;left:72pt;z-index:374;letter-spacing:-.004em;">Now, when the next point <span class="fmt-3">p</span> is considered, we determine which of the subsquares S<span class="fmt-4" style="position:relative;left:0pt;top:3pt;">s</span><span class="fmt-4" style="position:relative;left:0pt;top:3pt;">t</span> it belongs to. If p is</div></span><span style="white-space:pre;"><div style="position:absolute;top:163.23pt;left:72pt;z-index:459;letter-spacing:-.01em;">going to cause the minimum distance to change, there must be some earlier point p’ <span class="fmt-9">∈</span> P’ at distance less</div></span><span style="white-space:pre;"><div style="position:absolute;top:178.23pt;left:72pt;z-index:543;letter-spacing:-.005em;">than δ from it; and hence, by (13.27), the point <span class="fmt-3">p</span><span class="fmt-3">’</span> must be in one of the 25 squares around the square S<span class="fmt-4" style="position:relative;left:0pt;top:3pt;">s</span><span class="fmt-4" style="position:relative;left:0pt;top:3pt;">t</span></div></span><span style="white-space:pre;"><div style="position:absolute;top:193.23pt;left:72pt;z-index:627;letter-spacing:-.004em;">containing <span class="fmt-3">p</span><span class="fmt-3">.</span> So we will simply check each of these 25 squares one by one to see if it contains a point in</div></span><span style="white-space:pre;"><div style="position:absolute;top:208.23pt;left:72pt;z-index:709;letter-spacing:.007em;">P’; for each point in P’ that we find this way, we compute its distance to p. By (13.26), each of these</div></span><span style="white-space:pre;"><div style="position:absolute;top:223.23pt;left:72pt;z-index:798;letter-spacing:-.011em;">subsquares contains at most one point of P’, so this is at most a constant number of distance computations.</div></span><span style="white-space:pre;"><div style="position:absolute;top:238.23pt;left:72pt;z-index:890;letter-spacing:-.007em;">(Note that we used a similar idea, via (5. !0), at a crucial point in the divide­and­conquer algorithm for this</div></span><span style="white-space:pre;"><div style="position:absolute;top:253.23pt;left:72pt;z-index:909;letter-spacing:-.011em;">problem in Chapter 5.)</div></span><span style="white-space:pre;"><div style="position:absolute;top:283.23pt;left:72pt;z-index:997;letter-spacing:-.004em;"><span class="fmt-10">A</span> <span class="fmt-10">D</span><span class="fmt-10">a</span><span class="fmt-10">t</span><span class="fmt-10">a</span> <span class="fmt-10">S</span><span class="fmt-10">t</span><span class="fmt-10">r</span><span class="fmt-10">u</span><span class="fmt-10">c</span><span class="fmt-10">t</span><span class="fmt-10">u</span><span class="fmt-10">r</span><span class="fmt-10">e</span> <span class="fmt-10">f</span><span class="fmt-10">o</span><span class="fmt-10">r</span> <span class="fmt-10">M</span><span class="fmt-10">a</span><span class="fmt-10">i</span><span class="fmt-10">n</span><span class="fmt-10">t</span><span class="fmt-10">a</span><span class="fmt-10">i</span><span class="fmt-10">n</span><span class="fmt-10">i</span><span class="fmt-10">n</span><span class="fmt-10">g</span> <span class="fmt-10">t</span><span class="fmt-10">h</span><span class="fmt-10">e</span> <span class="fmt-10">S</span><span class="fmt-10">u</span><span class="fmt-10">b</span><span class="fmt-10">s</span><span class="fmt-10">q</span><span class="fmt-10">u</span><span class="fmt-10">a</span><span class="fmt-10">r</span><span class="fmt-10">e</span><span class="fmt-10">s</span><span class="fmt-10">:</span> The high­level description of the algorithm relies on</div></span><span style="white-space:pre;"><div style="position:absolute;top:298.23pt;left:72pt;z-index:1083;letter-spacing:-.004em;">being able to name a subsquare S<span class="fmt-4" style="position:relative;left:0pt;top:3pt;">s</span><span class="fmt-4" style="position:relative;left:0pt;top:3pt;">t</span> and quickly determine which points of P, if any, are contained in it. A</div></span><span style="white-space:pre;"><div style="position:absolute;top:313.23pt;left:72pt;z-index:1168;letter-spacing:-.007em;">dictionary  is  a  natural  data  structure  for  implementing  such  operations.  The universe U of possible</div></span><span style="white-space:pre;"><div style="position:absolute;top:328.23pt;left:72pt;z-index:1257;letter-spacing:-.008em;">elements is the set of all subsquares, and the set S maintained by the data structure will be the subsquares</div></span><span style="white-space:pre;"><div style="position:absolute;top:343.23pt;left:72pt;z-index:1344;letter-spacing:-.013em;">that contain points from among the set P’ that we’ve seen so far. Specifically, for each point <span class="fmt-3">p</span><span class="fmt-3">’</span> <span class="fmt-9">∈</span> P’ that</div></span><span style="white-space:pre;"><div style="position:absolute;top:358.23pt;left:72pt;z-index:1419;letter-spacing:-.014em;">we have seen so far, we keep the subsquare containing it in the dictionary, tagged with the</div></span><span style="white-space:pre;"><div style="position:absolute;top:373.23pt;left:72pt;z-index:1506;letter-spacing:-.011em;">index of <span class="fmt-3">p</span><span class="fmt-3">’</span>. We note that N<span class="fmt-4" style="position:relative;left:0pt;top:-4pt;">2</span> = [1/(2δ)]<span class="fmt-4" style="position:relative;left:0pt;top:-4pt;">2</span> will, in general, be much larger than n, the number of points. Thus</div></span><span style="white-space:pre;"><div style="position:absolute;top:388.23pt;left:72pt;z-index:1590;letter-spacing:.017em;">we are in the type of situation considered in Section 13.6 on hashing, where the universe of possible</div></span><span style="white-space:pre;"><div style="position:absolute;top:403.23pt;left:72pt;z-index:1672;letter-spacing:.022em;">elements (the set of all subsquares) is much larger than the number of elements being indexed (the</div></span><span style="white-space:pre;"><div style="position:absolute;top:418.23pt;left:72pt;z-index:1717;letter-spacing:-.011em;">subsquares containing an input point seen thus far).</div></span><span style="white-space:pre;"><div style="position:absolute;top:448.23pt;left:72pt;z-index:1803;letter-spacing:-.01em;">Now, when we consider the next point <span class="fmt-3">p</span> in the random order, we determine the subsquare S<span class="fmt-4" style="position:relative;left:0pt;top:3pt;">s</span><span class="fmt-4" style="position:relative;left:0pt;top:3pt;">t</span> containing it</div></span><span style="white-space:pre;"><div style="position:absolute;top:463.23pt;left:72pt;z-index:1888;letter-spacing:-.008em;">and perform a <span class="fmt-3">L</span><span class="fmt-3">o</span><span class="fmt-3">o</span><span class="fmt-3">k</span><span class="fmt-3">u</span><span class="fmt-3">p</span> operation for each of the 25 subsquares close to Sst. For any points discovered by</div></span><span style="white-space:pre;"><div style="position:absolute;top:478.23pt;left:72pt;z-index:1963;letter-spacing:-.014em;">these <span class="fmt-3">L</span><span class="fmt-3">o</span><span class="fmt-3">o</span><span class="fmt-3">k</span><span class="fmt-3">u</span><span class="fmt-3">p</span> operations, we compute the distance to p. If none of these distances are less</div></span><span style="white-space:pre;"><div style="position:absolute;top:493.23pt;left:72pt;z-index:2049;letter-spacing:.013em;">than δ, then the closest distance hasn’t changed; we insert S<span class="fmt-4" style="position:relative;left:0pt;top:3pt;">s</span><span class="fmt-4" style="position:relative;left:0pt;top:3pt;">t</span> (tagged with <span class="fmt-3">p</span>) into the dictionary and</div></span><span style="white-space:pre;"><div style="position:absolute;top:508.23pt;left:72pt;z-index:2071;letter-spacing:-.012em;">proceed to the next point.</div></span><span style="white-space:pre;"><div style="position:absolute;top:538.23pt;left:72pt;z-index:2153;letter-spacing:-.003em;">However, if we find a point <span class="fmt-3">p</span><span class="fmt-3">’</span> such that δ<span class="fmt-3">’</span> = <span class="fmt-3">d</span>(<span class="fmt-3">p</span>, <span class="fmt-3">p</span><span class="fmt-3">’</span>) &lt; δ, then we need to update our closest pair. This</div></span><span style="white-space:pre;"><div style="position:absolute;top:553.23pt;left:72pt;z-index:2239;letter-spacing:.009em;">updating is a rather dramatic activity: Since the value of the closest pair has dropped from δ to δ’, our</div></span><span style="white-space:pre;"><div style="position:absolute;top:568.23pt;left:72pt;z-index:2330;letter-spacing:.016em;">entire collection of subsquares, and the dictionary supporting it, has become useless­­it was, after all,</div></span><span style="white-space:pre;"><div style="position:absolute;top:583.23pt;left:72pt;z-index:2410;letter-spacing:.018em;">designed only to be useful if the minimum distance was δ. We therefore invoke <span class="fmt-3">M</span><span class="fmt-3">a</span><span class="fmt-3">k</span><span class="fmt-3">e</span><span class="fmt-3">D</span><span class="fmt-3">i</span><span class="fmt-3">c</span><span class="fmt-3">t</span><span class="fmt-3">i</span><span class="fmt-3">o</span><span class="fmt-3">n</span><span class="fmt-3">a</span><span class="fmt-3">r</span><span class="fmt-3">y</span> to</div></span><span style="white-space:pre;"><div style="position:absolute;top:598.23pt;left:72pt;z-index:2498;letter-spacing:-.005em;">create a new, empty dictionary that will hold subsquares whose side lengths are δ’/2. For each point seen</div></span><span style="white-space:pre;"><div style="position:absolute;top:613.23pt;left:72pt;z-index:2590;letter-spacing:-.009em;">thus far, we determine the subsquare containing it (in this new collection of subsquares), and we insert this</div></span><span style="white-space:pre;"><div style="position:absolute;top:628.23pt;left:72pt;z-index:2675;letter-spacing:.013em;">subsquare into the dictionary. Having done all this, we are again ready to handle the next point in the</div></span><span style="white-space:pre;"><div style="position:absolute;top:643.23pt;left:72pt;z-index:2687;letter-spacing:-.006em;">random order.</div></span><span style="white-space:pre;"><div style="position:absolute;top:673.23pt;left:72pt;z-index:2762;letter-spacing:-.013em;"><span class="fmt-11">S</span><span class="fmt-11">u</span><span class="fmt-11">m</span><span class="fmt-11">m</span><span class="fmt-11">a</span><span class="fmt-11">r</span><span class="fmt-11">y</span> <span class="fmt-11">o</span><span class="fmt-11">f</span> <span class="fmt-11">t</span><span class="fmt-11">h</span><span class="fmt-11">e</span> <span class="fmt-11">A</span><span class="fmt-11">l</span><span class="fmt-11">g</span><span class="fmt-11">o</span><span class="fmt-11">r</span><span class="fmt-11">i</span><span class="fmt-11">t</span><span class="fmt-11">h</span><span class="fmt-11">m</span><span class="fmt-11">:</span> We have now actually described the algorithm in full. To recap:</div></span><canvas id="_canv_15" style="position:absolute;left:0pt;top:0pt;width:612pt;height:792pt;z-index:1;" width="816" height="1056">Your browser does not support the canvas tag!</canvas><canvas id="_canv_16" style="position:absolute;left:0pt;top:-2376pt;width:612pt;height:7920pt;z-index:2;" width="816" height="10560">Your browser does not support the canvas tag!</canvas><canvas id="_canv_17" style="position:absolute;left:0pt;top:0pt;width:612pt;height:792pt;z-index:3;" width="816" height="1056">Your browser does not support the canvas tag!</canvas><canvas id="_canv_18" style="position:absolute;left:0pt;top:72pt;width:612pt;height:720pt;z-index:4;" width="816" height="960">Your browser does not support the canvas tag!</canvas><span class="fmt-18" style="white-space:pre;"><div style="position:absolute;top:703.63pt;left:72pt;z-index:2805;letter-spacing:.073em;">Order the points in a random sequence <span class="fmt-19">p</span><span class="fmt-20" style="position:relative;left:0pt;top:2pt;">l</span>,<span class="fmt-19">p</span><span class="fmt-20" style="position:relative;left:0pt;top:2pt;">2 </span>..... <span class="fmt-19">p</span><span class="fmt-20" style="position:relative;left:0pt;top:2pt;">n </span></div></span></div>
      </div>
      <script type="text/javascript">DrawPage4();</script>
      <div style="width:100%">
        <hr />
        <table style="border:0;width:100%;">
          <tbody>
            <tr>
              <td bgcolor="eeeeee" align="right">
                <font face="arial,sans-serif">
                  <b>Page 5</b>
                </font>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <div style="position:relative;width:612pt;height:792pt;">
        <div style="position:absolute;left:0pt;top:0pt;width:100%;height:100%;clip:rect(0pt,612pt,792pt,0pt);" class="fmt-1"><span class="fmt-18" style="white-space:pre;"><div style="position:absolute;top:73.6283pt;left:72pt;z-index:42;letter-spacing:.065em;">Let δ denote the minimum distance found so far </div></span><span class="fmt-18" style="white-space:pre;"><div style="position:absolute;top:87.1283pt;left:72pt;z-index:62;letter-spacing:.055em;">Initialize δ : <span class="fmt-19">d</span>(<span class="fmt-19">p</span><span class="fmt-20" style="position:relative;left:0pt;top:2pt;">l</span>, <span class="fmt-19">p</span><span class="fmt-20" style="position:relative;left:0pt;top:2pt;">2</span>) </div></span><span class="fmt-18" style="white-space:pre;"><div style="position:absolute;top:100.63pt;left:72pt;z-index:117;letter-spacing:.083em;">Invoke <span class="fmt-19">M</span><span class="fmt-19">a</span><span class="fmt-19">k</span><span class="fmt-19">e</span><span class="fmt-19">D</span><span class="fmt-19">i</span><span class="fmt-19">c</span><span class="fmt-19">t</span><span class="fmt-19">i</span><span class="fmt-19">o</span><span class="fmt-19">n</span><span class="fmt-19">a</span><span class="fmt-19">r</span><span class="fmt-19">y </span>for storing subsquares of side length δ/2 </div></span><span class="fmt-19" style="white-space:pre;"><div style="position:absolute;top:114.13pt;left:72pt;z-index:132;letter-spacing:.04em;"><span class="fmt-18">F</span><span class="fmt-18">o</span><span class="fmt-18">r </span>i=1, 2 ..... n: </div></span><span class="fmt-18" style="white-space:pre;"><div style="position:absolute;top:127.63pt;left:108pt;z-index:168;letter-spacing:.088em;">Determine the subsquare S<span class="fmt-21" style="position:relative;left:0pt;top:2pt;">s</span><span class="fmt-21" style="position:relative;left:0pt;top:2pt;">t </span>containing <span class="fmt-19">p</span><span class="fmt-20" style="position:relative;left:0pt;top:2pt;">i </span></div></span><span class="fmt-18" style="white-space:pre;"><div style="position:absolute;top:141.13pt;left:108pt;z-index:198;letter-spacing:.061em;">Look up the 25 subsquares close to <span class="fmt-19">p</span><span class="fmt-20" style="position:relative;left:0pt;top:2pt;">i </span></div></span><span class="fmt-18" style="white-space:pre;"><div style="position:absolute;top:154.63pt;left:108pt;z-index:255;letter-spacing:.076em;">Compute the distance from <span class="fmt-19">p</span><span class="fmt-20" style="position:relative;left:0pt;top:2pt;">i </span>to any points found in these subsquares </div></span><span class="fmt-18" style="white-space:pre;"><div style="position:absolute;top:168.13pt;left:108pt;z-index:302;letter-spacing:.057em;">If there is a point <span class="fmt-19">p</span><span class="fmt-20" style="position:relative;left:0pt;top:2pt;">j </span>(<span class="fmt-19">j</span><span class="fmt-19">&lt;</span><span class="fmt-19">i</span>) such that δ’=<span class="fmt-19">d</span>(<span class="fmt-19">p</span><span class="fmt-20" style="position:relative;left:0pt;top:2pt;">j </span><span class="fmt-19">,</span><span class="fmt-19">p</span><span class="fmt-20" style="position:relative;left:0pt;top:2pt;">i</span>) &lt; δ then </div></span><span class="fmt-18" style="white-space:pre;"><div style="position:absolute;top:181.63pt;left:144pt;z-index:328;letter-spacing:.082em;">Delete the current dictionary </div></span><span class="fmt-18" style="white-space:pre;"><div style="position:absolute;top:195.13pt;left:144pt;z-index:384;letter-spacing:.084em;">Invoke <span class="fmt-19">M</span><span class="fmt-19">a</span><span class="fmt-19">k</span><span class="fmt-19">e</span><span class="fmt-19">D</span><span class="fmt-19">i</span><span class="fmt-19">c</span><span class="fmt-19">t</span><span class="fmt-19">i</span><span class="fmt-19">o</span><span class="fmt-19">n</span><span class="fmt-19">a</span><span class="fmt-19">r</span><span class="fmt-19">y </span>for storing subsquares of side length δ’/2 </div></span><span class="fmt-18" style="white-space:pre;"><div style="position:absolute;top:208.63pt;left:144pt;z-index:415;letter-spacing:.07em;">For each of the points <span class="fmt-19">p</span><span class="fmt-20" style="position:relative;left:0pt;top:2pt;">l</span><span class="fmt-19">,</span><span class="fmt-19">p</span><span class="fmt-20" style="position:relative;left:0pt;top:2pt;">2</span><span class="fmt-19">,</span><span class="fmt-19">.</span><span class="fmt-19">.</span><span class="fmt-19">.</span><span class="fmt-19">.</span><span class="fmt-19">p</span><span class="fmt-20" style="position:relative;left:0pt;top:2pt;">i</span>: </div></span><span class="fmt-18" style="white-space:pre;"><div style="position:absolute;top:222.13pt;left:180pt;z-index:466;letter-spacing:.076em;">Determine the subsquare of side length δ’/2 that contains it </div></span><span class="fmt-18" style="white-space:pre;"><div style="position:absolute;top:235.63pt;left:180pt;z-index:505;letter-spacing:.078em;">Insert this subsquare into the new dictionary </div></span><span class="fmt-18" style="white-space:pre;"><div style="position:absolute;top:249.13pt;left:144pt;z-index:511;letter-spacing:.025em;">End for </div></span><span class="fmt-18" style="white-space:pre;"><div style="position:absolute;top:262.63pt;left:108pt;z-index:515;letter-spacing:.027em;">Else </div></span><span class="fmt-18" style="white-space:pre;"><div style="position:absolute;top:276.13pt;left:144pt;z-index:547;letter-spacing:.082em;">Insert <span class="fmt-19">p</span><span class="fmt-20" style="position:relative;left:0pt;top:2pt;">i </span>into the current dictionary </div></span><span class="fmt-18" style="white-space:pre;"><div style="position:absolute;top:289.63pt;left:108pt;z-index:552;letter-spacing:.045em;">Endif </div></span><span class="fmt-18" style="white-space:pre;"><div style="position:absolute;top:303.13pt;left:72pt;z-index:558;letter-spacing:.057em;">Endfor </div></span><span class="fmt-2" style="white-space:pre;"><div style="position:absolute;top:330.8pt;left:72pt;z-index:579;letter-spacing:-.007em;">Analyzing the Algorithm</div></span><span style="white-space:pre;"><div style="position:absolute;top:365.73pt;left:72pt;z-index:664;letter-spacing:-.002em;">There are already some things we can say about the overall running time of the algorithm. To consider a</div></span><span style="white-space:pre;"><div style="position:absolute;top:380.73pt;left:72pt;z-index:747;letter-spacing:-.007em;">new point Pi, we need to perform only a constant number of Lookup operations and a constant number of</div></span><span style="white-space:pre;"><div style="position:absolute;top:395.73pt;left:72pt;z-index:837;letter-spacing:-.01em;">distance computations. Moreover, even if we had to update the closest pair in every iteration, we’d only do</div></span><span class="fmt-3" style="white-space:pre;"><div style="position:absolute;top:410.73pt;left:72pt;z-index:863;letter-spacing:-.006em;"><span class="fmt-1">n</span> MakeDictionary <span class="fmt-1">o</span><span class="fmt-1">p</span><span class="fmt-1">e</span><span class="fmt-1">r</span><span class="fmt-1">a</span><span class="fmt-1">t</span><span class="fmt-1">i</span><span class="fmt-1">o</span><span class="fmt-1">n</span><span class="fmt-1">s</span><span class="fmt-1">.</span></div></span><span style="white-space:pre;"><div style="position:absolute;top:440.73pt;left:72pt;z-index:950;letter-spacing:.013em;">The missing ingredient is the total expected cost, over the course of the algorithm’s execution, due to</div></span><span style="white-space:pre;"><div style="position:absolute;top:455.73pt;left:72pt;z-index:1041;letter-spacing:-.01em;">reinsertions into new dictionaries when the closest pair is updated. We will consider this next. For now, we</div></span><span style="white-space:pre;"><div style="position:absolute;top:470.73pt;left:72pt;z-index:1099;letter-spacing:-.013em;">can at least summarize the current state of our knowledge as follows:</div></span><span class="fmt-3" style="white-space:pre;"><div style="position:absolute;top:500.73pt;left:72pt;z-index:1183;letter-spacing:-.002em;"><span class="fmt-11">(</span><span class="fmt-11">1</span><span class="fmt-11">3</span><span class="fmt-11">.</span><span class="fmt-11">2</span><span class="fmt-11">8</span><span class="fmt-11">)</span> The algorithm correctly maintains the closest pair at all times and it performs at most O(n)</div></span><span class="fmt-3" style="white-space:pre;"><div style="position:absolute;top:515.73pt;left:72pt;z-index:1257;letter-spacing:-.008em;">distance computations; O(n) Lookup operations, and O(n) MakeDictionary operations.</div></span><span style="white-space:pre;"><div style="position:absolute;top:545.73pt;left:72pt;z-index:1340;letter-spacing:.008em;">We now conclude the analysis by bounding the expected number of <span class="fmt-3">I</span><span class="fmt-3">n</span><span class="fmt-3">s</span><span class="fmt-3">e</span><span class="fmt-3">r</span><span class="fmt-3">t</span> operations. Trying to find a</div></span><span style="white-space:pre;"><div style="position:absolute;top:560.73pt;left:72pt;z-index:1427;letter-spacing:-.004em;">good bound on the total expected number of <span class="fmt-3">I</span><span class="fmt-3">n</span><span class="fmt-3">s</span><span class="fmt-3">e</span><span class="fmt-3">r</span><span class="fmt-3">t</span> operations seems a bit problematic at first: An update</div></span><span style="white-space:pre;"><div style="position:absolute;top:575.73pt;left:72pt;z-index:1515;letter-spacing:.003em;">to the closest pair in iteration i will result in i insertions, and so each update comes at a high cost once i</div></span><span style="white-space:pre;"><div style="position:absolute;top:590.73pt;left:72pt;z-index:1603;letter-spacing:.007em;">gets large. Despite this, we will show the surprising fact that the expected number of insertions is only</div></span><span style="white-space:pre;"><div style="position:absolute;top:605.73pt;left:72pt;z-index:1690;letter-spacing:.007em;">O(n). The intuition here is that, even as the cost of updates becomes steeper as the iterations proceed,</div></span><span style="white-space:pre;"><div style="position:absolute;top:620.73pt;left:72pt;z-index:1734;letter-spacing:-.008em;">these updates become correspondingly less likely.</div></span><span style="white-space:pre;"><div style="position:absolute;top:650.73pt;left:72pt;z-index:1816;letter-spacing:.019em;">Let X be a random variable specifying the number of <span class="fmt-3">I</span><span class="fmt-3">n</span><span class="fmt-3">s</span><span class="fmt-3">e</span><span class="fmt-3">r</span><span class="fmt-3">t</span> operations performed; the value of this</div></span><span style="white-space:pre;"><div style="position:absolute;top:665.73pt;left:72pt;z-index:1901;letter-spacing:.004em;">random variable is determined by the random order chosen at the outset. We are interested in bounding</div></span><canvas id="_canv_19" style="position:absolute;left:0pt;top:0pt;width:612pt;height:792pt;z-index:1;" width="816" height="1056">Your browser does not support the canvas tag!</canvas><canvas id="_canv_20" style="position:absolute;left:0pt;top:-3168pt;width:612pt;height:7920pt;z-index:2;" width="816" height="10560">Your browser does not support the canvas tag!</canvas><canvas id="_canv_21" style="position:absolute;left:0pt;top:0pt;width:612pt;height:792pt;z-index:3;" width="816" height="1056">Your browser does not support the canvas tag!</canvas><canvas id="_canv_22" style="position:absolute;left:0pt;top:72pt;width:612pt;height:720pt;z-index:4;" width="816" height="960">Your browser does not support the canvas tag!</canvas><span style="white-space:pre;"><div style="position:absolute;top:680.73pt;left:72pt;z-index:1984;letter-spacing:.009em;">E[X], and as usual in this type of situation, it is helpful to break X down into a sum of simpler random</div></span></div>
      </div>
      <script type="text/javascript">DrawPage5();</script>
      <div style="width:100%">
        <hr />
        <table style="border:0;width:100%;">
          <tbody>
            <tr>
              <td bgcolor="eeeeee" align="right">
                <font face="arial,sans-serif">
                  <b>Page 6</b>
                </font>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <div style="position:relative;width:612pt;height:792pt;">
        <div style="position:absolute;left:0pt;top:0pt;width:100%;height:100%;clip:rect(0pt,612pt,792pt,0pt);" class="fmt-1"><span style="white-space:pre;"><div style="position:absolute;top:73.2263pt;left:72pt;z-index:86;letter-spacing:.017em;">variables. Thus let X<span class="fmt-4" style="position:relative;left:0pt;top:3pt;">i</span> be a random variable equal to 1 if the i<span class="fmt-4" style="position:relative;left:0pt;top:-4pt;">t</span><span class="fmt-4" style="position:relative;left:0pt;top:-4pt;">h</span> point in the random order causes the</div></span><span style="white-space:pre;"><div style="position:absolute;top:88.2263pt;left:72pt;z-index:131;letter-spacing:-.012em;">minimum distance to change, and equal to 0 otherwise.</div></span><span style="white-space:pre;"><div style="position:absolute;top:118.23pt;left:72pt;z-index:219;letter-spacing:-.007em;">Using these random variables X<span class="fmt-4" style="position:relative;left:0pt;top:3pt;">i</span>, we can write a simple formula for the total number of <span class="fmt-3">I</span><span class="fmt-3">n</span><span class="fmt-3">s</span><span class="fmt-3">e</span><span class="fmt-3">r</span><span class="fmt-3">t</span> operations.</div></span><span style="white-space:pre;"><div style="position:absolute;top:133.23pt;left:72pt;z-index:307;letter-spacing:-.004em;">Each point is inserted once when it is first encountered; and i points need to be reinserted if the minimum</div></span><span style="white-space:pre;"><div style="position:absolute;top:148.23pt;left:72pt;z-index:363;letter-spacing:-.012em;">distance changes in iteration i. Thus we have the following claim.</div></span><span class="fmt-3" style="white-space:pre;"><div style="position:absolute;top:178.23pt;left:72pt;z-index:435;letter-spacing:-.014em;"><span class="fmt-11">(</span><span class="fmt-11">1</span><span class="fmt-11">3</span><span class="fmt-11">.</span><span class="fmt-11">2</span><span class="fmt-11">9</span><span class="fmt-11">)</span> The total number of Insert operations performed by the algorithm is n + Σ<span class="fmt-8" style="position:relative;left:0pt;top:3pt;">i</span> iX<span class="fmt-8" style="position:relative;left:0pt;top:3pt;">i</span>.</div></span><span style="white-space:pre;"><div style="position:absolute;top:208.23pt;left:72pt;z-index:519;letter-spacing:.005em;">Now we bound the probability Pr [Xi = 1] that considering the i<span class="fmt-4" style="position:relative;left:0pt;top:-4pt;">t</span><span class="fmt-4" style="position:relative;left:0pt;top:-4pt;">h</span> point causes the minimum distance to</div></span><span style="white-space:pre;"><div style="position:absolute;top:223.23pt;left:72pt;z-index:526;">change.</div></span><span style="white-space:pre;"><div style="position:absolute;top:253.23pt;left:72pt;z-index:545;letter-spacing:-.02em;"><span class="fmt-11">(</span><span class="fmt-11">1</span><span class="fmt-11">3</span><span class="fmt-11">.</span><span class="fmt-11">3</span><span class="fmt-11">0</span><span class="fmt-11">)</span> Pr [X<span class="fmt-4" style="position:relative;left:0pt;top:3pt;">i</span> = 1] ≤ 2/i</div></span><span style="white-space:pre;"><div style="position:absolute;top:283.23pt;left:72pt;z-index:631;letter-spacing:.005em;"><span class="fmt-11">P</span><span class="fmt-11">r</span><span class="fmt-11">o</span><span class="fmt-11">o</span><span class="fmt-11">f</span><span class="fmt-11">.</span> Consider the first i points <span class="fmt-3">p</span><span class="fmt-8" style="position:relative;left:0pt;top:3pt;">1</span><span class="fmt-3">,</span> <span class="fmt-3">p</span><span class="fmt-8" style="position:relative;left:0pt;top:3pt;">2</span> <span class="fmt-3">.</span><span class="fmt-3">.</span><span class="fmt-3">.</span><span class="fmt-3">.</span><span class="fmt-3">.</span> <span class="fmt-3">p</span><span class="fmt-8" style="position:relative;left:0pt;top:3pt;">i</span> in the random order. Assume that the minimum distance</div></span><span style="white-space:pre;"><div style="position:absolute;top:298.23pt;left:72pt;z-index:710;letter-spacing:.011em;">among these points is achieved by p and q. Now the point <span class="fmt-3">p</span><span class="fmt-8" style="position:relative;left:0pt;top:3pt;">i</span> can only cause the minimum distance to</div></span><span style="white-space:pre;"><div style="position:absolute;top:313.23pt;left:72pt;z-index:795;letter-spacing:-.006em;">decrease if <span class="fmt-3">p</span><span class="fmt-8" style="position:relative;left:0pt;top:3pt;">i</span> = <span class="fmt-3">p</span> or <span class="fmt-3">p</span><span class="fmt-8" style="position:relative;left:0pt;top:3pt;">i</span> <span class="fmt-3">=</span> <span class="fmt-3">q</span><span class="fmt-3">.</span> Since the first i points are in a random order, any of them is equally likely to</div></span><span style="white-space:pre;"><div style="position:absolute;top:328.23pt;left:72pt;z-index:838;letter-spacing:-.018em;">be last, so the probability that p or q is last is 2/i.</div></span><span style="white-space:pre;"><div style="position:absolute;top:358.23pt;left:72pt;z-index:922;letter-spacing:.012em;">Note that 2/i is only an upper bound in (13.30) because there could be multiple pairs among the first i</div></span><span style="white-space:pre;"><div style="position:absolute;top:373.23pt;left:72pt;z-index:962;letter-spacing:-.01em;">points that define the same smallest distance.</div></span><span style="white-space:pre;"><div style="position:absolute;top:403.23pt;left:72pt;z-index:1026;letter-spacing:-.014em;">By (13.29) and (13.30), we can bound the total number of <span class="fmt-3">I</span><span class="fmt-3">n</span><span class="fmt-3">s</span><span class="fmt-3">e</span><span class="fmt-3">r</span><span class="fmt-3">t</span> operations as</div></span><span style="white-space:pre;"><div style="position:absolute;top:439.23pt;left:72pt;z-index:1050;letter-spacing:-.025em;">E[X] = n + <span class="fmt-12" style="position:relative;left:0pt;top:-1pt;">∑</span> i.E[x<span class="fmt-4" style="position:relative;left:0pt;top:3pt;">i</span>] ≤ n + 2n = 3n.</div></span><span class="fmt-22" style="white-space:pre;"><div style="position:absolute;top:451.98pt;left:127.74pt;z-index:1051;">i</div></span><span style="white-space:pre;"><div style="position:absolute;top:478.23pt;left:72pt;z-index:1132;letter-spacing:-.013em;">Combining this with (13.28), we obtain the following bound on the running time of the algorithm.</div></span><span class="fmt-3" style="white-space:pre;"><div style="position:absolute;top:508.23pt;left:72pt;z-index:1211;letter-spacing:-.004em;"><span class="fmt-11">(</span><span class="fmt-11">1</span><span class="fmt-11">3</span><span class="fmt-11">.</span><span class="fmt-11">3</span><span class="fmt-11">1</span><span class="fmt-11">)</span>  In  expectation,  the  randomized  closest­pair  algorithm  requires  O(n)  time  plus  O(n)</div></span><span class="fmt-3" style="white-space:pre;"><div style="position:absolute;top:523.23pt;left:72pt;z-index:1232;letter-spacing:-.003em;">dictionary operations.</div></span><span class="fmt-2" style="white-space:pre;"><div style="position:absolute;top:552.8pt;left:72pt;z-index:1266;letter-spacing:-.008em;">Achieving Linear Expected Running Time</div></span><span style="white-space:pre;"><div style="position:absolute;top:592.23pt;left:72pt;z-index:1352;letter-spacing:-.003em;">Up to this point, we have treated the dictionary data structure as a black box, and in (13.31) we bounded</div></span><span style="white-space:pre;"><div style="position:absolute;top:607.23pt;left:72pt;z-index:1440;letter-spacing:-.003em;">the running time of the algorithm in terms of computational time plus dictionary operations. We now want</div></span><span style="white-space:pre;"><div style="position:absolute;top:622.23pt;left:72pt;z-index:1510;letter-spacing:-.016em;">to give a bound on the actual expected running time, and so we need to analyze the work</div></span><span style="white-space:pre;"><div style="position:absolute;top:637.23pt;left:72pt;z-index:1556;letter-spacing:-.008em;">involved in performing these dictionary operations.</div></span><span style="white-space:pre;"><div style="position:absolute;top:667.23pt;left:72pt;z-index:1646;letter-spacing:-.004em;">To implement the dictionary, we’ll use a universal hashing scheme, like the one discussed in Section 13.6.</div></span><canvas id="_canv_23" style="position:absolute;left:0pt;top:0pt;width:612pt;height:792pt;z-index:1;" width="816" height="1056">Your browser does not support the canvas tag!</canvas><canvas id="_canv_24" style="position:absolute;left:0pt;top:-3960pt;width:612pt;height:7920pt;z-index:2;" width="816" height="10560">Your browser does not support the canvas tag!</canvas><canvas id="_canv_25" style="position:absolute;left:0pt;top:0pt;width:612pt;height:792pt;z-index:3;" width="816" height="1056">Your browser does not support the canvas tag!</canvas><canvas id="_canv_26" style="position:absolute;left:0pt;top:72pt;width:612pt;height:720pt;z-index:4;" width="816" height="960">Your browser does not support the canvas tag!</canvas><span style="white-space:pre;"><div style="position:absolute;top:682.23pt;left:72pt;z-index:1733;letter-spacing:-.005em;">Once the algorithm employs a hashing scheme, it is making use of randomness in two distinct ways: First,</div></span></div>
      </div>
      <script type="text/javascript">DrawPage6();</script>
      <div style="width:100%">
        <hr />
        <table style="border:0;width:100%;">
          <tbody>
            <tr>
              <td bgcolor="eeeeee" align="right">
                <font face="arial,sans-serif">
                  <b>Page 7</b>
                </font>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <div style="position:relative;width:612pt;height:792pt;">
        <div style="position:absolute;left:0pt;top:0pt;width:100%;height:100%;clip:rect(0pt,612pt,792pt,0pt);" class="fmt-1"><span style="white-space:pre;"><div style="position:absolute;top:73.2263pt;left:72pt;z-index:82;letter-spacing:.018em;">we randomly order the points to be added; and second, for each new minimum distance δ, we apply</div></span><span style="white-space:pre;"><div style="position:absolute;top:88.2263pt;left:72pt;z-index:144;letter-spacing:-.013em;">randomization to set up a new hash table using a universal hashing scheme.</div></span><span style="white-space:pre;"><div style="position:absolute;top:118.23pt;left:72pt;z-index:232;letter-spacing:-.007em;">When inserting a new point <span class="fmt-3">p</span><span class="fmt-8" style="position:relative;left:0pt;top:3pt;">i</span><span class="fmt-3">,</span> the algorithm uses the hash­table <span class="fmt-3">L</span><span class="fmt-3">o</span><span class="fmt-3">o</span><span class="fmt-3">k</span><span class="fmt-3">u</span><span class="fmt-3">p</span> operation to find all nodes in the</div></span><span style="white-space:pre;"><div style="position:absolute;top:133.23pt;left:72pt;z-index:320;letter-spacing:-.003em;">25 subsquares close to <span class="fmt-3">p</span><span class="fmt-8" style="position:relative;left:0pt;top:3pt;">i</span>. However, if the hash table has collisions, then these 25 Lookup operations can</div></span><span style="white-space:pre;"><div style="position:absolute;top:148.23pt;left:72pt;z-index:406;letter-spacing:-.002em;">involve inspecting many more than 25 nodes. Statement (13.23) from Section ,13.6 shows that each such</div></span><span style="white-space:pre;"><div style="position:absolute;top:163.23pt;left:72pt;z-index:501;letter-spacing:-.002em;"><span class="fmt-3">L</span><span class="fmt-3">o</span><span class="fmt-3">o</span><span class="fmt-3">k</span><span class="fmt-3">u</span><span class="fmt-3">p</span> operation involves considering O(1) previously inserted points, in expectation. It seems intuitively</div></span><span style="white-space:pre;"><div style="position:absolute;top:178.23pt;left:72pt;z-index:592;">clear that performing O(n) hash­table operations in expectation, each of which involves considering O(1)</div></span><span style="white-space:pre;"><div style="position:absolute;top:193.23pt;left:72pt;z-index:680;letter-spacing:.013em;">elements in expectation, will result in an expected running time of O(n) overall. To make this intuition</div></span><span style="white-space:pre;"><div style="position:absolute;top:208.23pt;left:72pt;z-index:748;letter-spacing:-.013em;">precise, we need to be careful with how these two sources of randomness interact.</div></span><span class="fmt-3" style="white-space:pre;"><div style="position:absolute;top:238.23pt;left:72pt;z-index:828;letter-spacing:.013em;"><span class="fmt-11">(</span><span class="fmt-11">1</span><span class="fmt-11">3</span><span class="fmt-11">.</span><span class="fmt-11">3</span><span class="fmt-11">2</span><span class="fmt-11">)</span>  Assume we implement the randomized closest­pair algorithm using a universal hashing</div></span><span class="fmt-3" style="white-space:pre;"><div style="position:absolute;top:253.23pt;left:72pt;z-index:908;letter-spacing:.015em;">scheme. In expectation, the total number of points considered during the Lookup operations is</div></span><span class="fmt-3" style="white-space:pre;"><div style="position:absolute;top:268.23pt;left:72pt;z-index:922;letter-spacing:-.01em;">bounded by O(n).</div></span><span style="white-space:pre;"><div style="position:absolute;top:298.23pt;left:72pt;z-index:1005;letter-spacing:-.004em;"><span class="fmt-11">P</span><span class="fmt-11">r</span><span class="fmt-11">o</span><span class="fmt-11">o</span><span class="fmt-11">f</span><span class="fmt-11">.</span> From (13.31) we know that the expected number of <span class="fmt-3">L</span><span class="fmt-3">o</span><span class="fmt-3">o</span><span class="fmt-3">k</span><span class="fmt-3">u</span><span class="fmt-3">p</span> operations is O(n), and from (13.23)</div></span><span style="white-space:pre;"><div style="position:absolute;top:313.23pt;left:72pt;z-index:1091;letter-spacing:.004em;">we know that each of these <span class="fmt-3">L</span><span class="fmt-3">o</span><span class="fmt-3">o</span><span class="fmt-3">k</span><span class="fmt-3">u</span><span class="fmt-3">p</span> operations involves considering only O(1) points in expectation. In</div></span><span style="white-space:pre;"><div style="position:absolute;top:328.23pt;left:72pt;z-index:1179;letter-spacing:-.007em;">order to conclude that this implies the expected number of points considered is O(n), we now consider the</div></span><span style="white-space:pre;"><div style="position:absolute;top:343.23pt;left:72pt;z-index:1226;letter-spacing:-.009em;">relationship between these two sources of randomness.</div></span><span style="white-space:pre;"><div style="position:absolute;top:373.23pt;left:72pt;z-index:1309;letter-spacing:-.005em;">Let X be a random variable denoting the number of <span class="fmt-3">L</span><span class="fmt-3">o</span><span class="fmt-3">o</span><span class="fmt-3">k</span><span class="fmt-3">u</span><span class="fmt-3">p</span> operations performed by the algorithm. Now</div></span><span style="white-space:pre;"><div style="position:absolute;top:388.23pt;left:72pt;z-index:1392;letter-spacing:.018em;">the random order σ that the algorithm chooses for the points completely determines the sequence of</div></span><span style="white-space:pre;"><div style="position:absolute;top:403.23pt;left:72pt;z-index:1479;letter-spacing:.017em;">minimum distance values the algorithm will consider and the sequence of dictionary operations it will</div></span><span style="white-space:pre;"><div style="position:absolute;top:418.23pt;left:72pt;z-index:1564;letter-spacing:-.007em;">perform. As a result, the choice of σ determines the value of X; we let X(σ) denote this value, and we let</div></span><span style="white-space:pre;"><div style="position:absolute;top:433.23pt;left:72pt;z-index:1652;letter-spacing:-.007em;">ξ<span class="fmt-4" style="position:relative;left:0pt;top:3pt;">σ</span> denote the event the algorithm chooses the random order or. Note that the conditional expectation E [X</div></span><span style="white-space:pre;"><div style="position:absolute;top:448.23pt;left:72pt;z-index:1722;letter-spacing:-.018em;">|ξ<span class="fmt-4" style="position:relative;left:0pt;top:3pt;">σ</span> ] is equal to X(σ). Also, by (13.31), we know that E [X] ≤ c<span class="fmt-4" style="position:relative;left:0pt;top:3pt;">0</span>n, for some constant c<span class="fmt-4" style="position:relative;left:0pt;top:3pt;">0</span>.</div></span><span style="white-space:pre;"><div style="position:absolute;top:463.23pt;left:72pt;z-index:1805;letter-spacing:-.002em;">Now consider this sequence of <span class="fmt-3">L</span><span class="fmt-3">o</span><span class="fmt-3">o</span><span class="fmt-3">k</span><span class="fmt-3">u</span><span class="fmt-3">p</span> operations for a fixed order σ . For i = 1 ..... X(σ), let Y<span class="fmt-4" style="position:relative;left:0pt;top:3pt;">i</span> be the</div></span><span style="white-space:pre;"><div style="position:absolute;top:478.23pt;left:72pt;z-index:1888;letter-spacing:.019em;">number of points that need to be inspected during the i<span class="fmt-4" style="position:relative;left:0pt;top:-4pt;">t</span><span class="fmt-4" style="position:relative;left:0pt;top:-4pt;">h</span> <span class="fmt-3">L</span><span class="fmt-3">o</span><span class="fmt-3">o</span><span class="fmt-3">k</span><span class="fmt-3">u</span><span class="fmt-3">p</span> operations­­namely, the number of</div></span><span style="white-space:pre;"><div style="position:absolute;top:493.23pt;left:72pt;z-index:1977;letter-spacing:-.011em;">previously inserted points that collide with the dictionary entry involved in this <span class="fmt-3">L</span><span class="fmt-3">o</span><span class="fmt-3">o</span><span class="fmt-3">k</span><span class="fmt-3">u</span><span class="fmt-3">p</span> operation. We</div></span><span class="fmt-14" style="white-space:pre;"><div style="position:absolute;top:507.48pt;left:275.02pt;z-index:2061;"><span class="fmt-22">X</span>(σ)</div></span><span style="white-space:pre;"><div style="position:absolute;top:515.73pt;left:72pt;z-index:2065;letter-spacing:.003em;">would like to bound the expected value of  <span class="fmt-12" style="position:relative;left:0pt;top:-1pt;">∑</span> <span class="fmt-15">Y</span> <span class="fmt-15">i</span>, where expectation is over both the random choice of</div></span><span class="fmt-14" style="white-space:pre;"><div style="position:absolute;top:528.48pt;left:276.57pt;z-index:2064;letter-spacing:.001em;"><span class="fmt-22">i</span>=1</div></span><span style="white-space:pre;"><div style="position:absolute;top:540.48pt;left:72pt;z-index:2099;letter-spacing:-.014em;">σ and the random choice of hash function.</div></span><span style="white-space:pre;"><div style="position:absolute;top:570.48pt;left:72pt;z-index:2182;letter-spacing:-.001em;">By (13.23), we know that E [Y<span class="fmt-4" style="position:relative;left:0pt;top:3pt;">i</span>|<span class="fmt-12">ξ</span><span class="fmt-12">σ</span>] = O(1) for all σ and all values of i. It is useful to be able to refer to</div></span><span style="white-space:pre;"><div style="position:absolute;top:586.98pt;left:72pt;z-index:2266;letter-spacing:-.01em;">the constant in the expression O(1) here, so we will say that E [Y<span class="fmt-4" style="position:relative;left:0pt;top:3pt;">i</span> | <span class="fmt-12">ξ</span><span class="fmt-12">σ</span> ] ≤ c<span class="fmt-4" style="position:relative;left:0pt;top:3pt;">1</span> for all  σ and all values of i.</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:72pt;z-index:2267;">S</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:78.2567pt;z-index:2268;">u</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:83.8817pt;z-index:2269;">m</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:92.6324pt;z-index:2270;">m</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:101.38pt;z-index:2271;">i</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:104.51pt;z-index:2272;">n</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:110.13pt;z-index:2273;">g</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:118.57pt;z-index:2274;">o</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:124.2pt;z-index:2275;">v</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:129.82pt;z-index:2276;">e</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:134.81pt;z-index:2277;">r</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:141.37pt;z-index:2278;">a</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:146.37pt;z-index:2279;">l</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:149.49pt;z-index:2280;">l</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:155.43pt;z-index:2281;">i</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:158.56pt;z-index:2282;">,</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:164.18pt;z-index:2283;">a</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:169.17pt;z-index:2284;">n</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:174.8pt;z-index:2285;">d</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:183.24pt;z-index:2286;">u</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:188.86pt;z-index:2287;">s</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:193.24pt;z-index:2288;">i</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:196.37pt;z-index:2289;">n</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:201.99pt;z-index:2290;">g</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:210.43pt;z-index:2291;">l</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:213.55pt;z-index:2292;">i</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:216.68pt;z-index:2293;">n</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:222.3pt;z-index:2294;">e</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:227.3pt;z-index:2295;">a</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:232.29pt;z-index:2296;">r</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:236.04pt;z-index:2297;">i</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:239.16pt;z-index:2298;">t</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:242.29pt;z-index:2299;">y</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:250.73pt;z-index:2300;">o</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:256.35pt;z-index:2301;">f</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:262.91pt;z-index:2302;">e</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:267.9pt;z-index:2303;">x</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:273.53pt;z-index:2304;">p</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:279.15pt;z-index:2305;">e</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:284.15pt;z-index:2306;">c</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:289.14pt;z-index:2307;">t</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:292.26pt;z-index:2308;">a</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:297.26pt;z-index:2309;">t</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:300.38pt;z-index:2310;">i</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:303.51pt;z-index:2311;">o</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:309.13pt;z-index:2312;">n</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:314.76pt;z-index:2313;">,</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:320.38pt;z-index:2314;">w</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:328.51pt;z-index:2315;">e</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:336.31pt;z-index:2316;">g</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:341.94pt;z-index:2317;">e</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:346.93pt;z-index:2318;">t</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:352.87pt;z-index:2319;">E</div></span><span class="fmt-23" style="white-space:pre;"><div style="position:absolute;top:601.19pt;left:361.5pt;z-index:2342;">[</div></span><span class="fmt-12" style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:370.87pt;z-index:2343;">∑</div></span><span class="fmt-22" style="white-space:pre;"><div style="position:absolute;top:624.48pt;left:373.35pt;z-index:2344;">i</div></span><span class="fmt-15" style="white-space:pre;"><div style="position:absolute;top:611.73pt;left:380.04pt;z-index:2345;">Y</div></span><span class="fmt-15" style="white-space:pre;"><div style="position:absolute;top:611.73pt;left:388.55pt;z-index:2338;">i</div></span><span class="fmt-12" style="white-space:pre;"><div style="position:absolute;top:611.73pt;left:391.67pt;z-index:2339;">|</div></span><span class="fmt-12" style="white-space:pre;"><div style="position:absolute;top:611.73pt;left:396.74pt;z-index:2340;">ξ</div></span><span class="fmt-12" style="white-space:pre;"><div style="position:absolute;top:611.73pt;left:401.75pt;z-index:2341;">σ</div></span><span class="fmt-23" style="white-space:pre;"><div style="position:absolute;top:601.19pt;left:407.82pt;z-index:2346;">]</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:421.06pt;z-index:2320;letter-spacing:.001em;">≤</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:430.04pt;z-index:2321;">c</div></span><span class="fmt-4" style="white-space:pre;"><div style="position:absolute;top:617.99pt;left:435.04pt;z-index:2322;">1</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:438.41pt;z-index:2323;">.</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:441.22pt;z-index:2324;">X</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:449.35pt;z-index:2325;">(</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:453.09pt;z-index:2326;">σ</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:459.16pt;z-index:2327;">)</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:462.9pt;z-index:2328;">.</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:468.53pt;z-index:2329;">N</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:476.65pt;z-index:2330;">o</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:482.28pt;z-index:2331;">w</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:493.22pt;z-index:2332;">w</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:501.34pt;z-index:2333;">e</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:509.15pt;z-index:2334;">h</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:514.77pt;z-index:2335;">a</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:519.76pt;z-index:2336;">v</div></span><span style="white-space:pre;"><div style="position:absolute;top:610.98pt;left:525.39pt;z-index:2337;">e</div></span><canvas id="_canv_27" style="position:absolute;left:0pt;top:0pt;width:612pt;height:792pt;z-index:1;" width="816" height="1056">Your browser does not support the canvas tag!</canvas><canvas id="_canv_28" style="position:absolute;left:0pt;top:-4752pt;width:612pt;height:7920pt;z-index:2;" width="816" height="10560">Your browser does not support the canvas tag!</canvas><canvas id="_canv_29" style="position:absolute;left:0pt;top:0pt;width:612pt;height:792pt;z-index:3;" width="816" height="1056">Your browser does not support the canvas tag!</canvas><canvas id="_canv_30" style="position:absolute;left:0pt;top:72pt;width:612pt;height:720pt;z-index:4;" width="816" height="960">Your browser does not support the canvas tag!</canvas><span class="fmt-15" style="white-space:pre;"><div style="position:absolute;top:658.98pt;left:76.5pt;z-index:2348;letter-spacing:.001em;">E</div></span><span class="fmt-23" style="white-space:pre;"><div style="position:absolute;top:648.44pt;left:84.8719pt;z-index:2350;">[</div></span><span class="fmt-22" style="white-space:pre;"><div style="position:absolute;top:650.73pt;left:94.0079pt;z-index:2352;">X</div></span><span class="fmt-22" style="white-space:pre;"><div style="position:absolute;top:671.73pt;left:96.0269pt;z-index:2356;">i</div></span><span class="fmt-12" style="white-space:pre;"><div style="position:absolute;top:658.23pt;left:98.7378pt;z-index:2351;">∑</div></span><span class="fmt-14" style="white-space:pre;"><div style="position:absolute;top:650.73pt;left:98.8182pt;z-index:2353;">(</div></span><span class="fmt-14" style="white-space:pre;"><div style="position:absolute;top:650.73pt;left:101.44pt;z-index:2354;">σ</div></span><span class="fmt-14" style="white-space:pre;"><div style="position:absolute;top:671.73pt;left:98.2148pt;z-index:2357;">=</div></span><span class="fmt-14" style="white-space:pre;"><div style="position:absolute;top:671.73pt;left:102.66pt;z-index:2358;">1</div></span><span class="fmt-14" style="white-space:pre;"><div style="position:absolute;top:650.73pt;left:107.65pt;z-index:2355;">)</div></span><span class="fmt-15" style="white-space:pre;"><div style="position:absolute;top:658.98pt;left:111.09pt;z-index:2359;">Y</div></span><span class="fmt-15" style="white-space:pre;"><div style="position:absolute;top:658.98pt;left:119.6pt;z-index:2349;">i</div></span><span class="fmt-23" style="white-space:pre;"><div style="position:absolute;top:648.44pt;left:122.73pt;z-index:2360;">]</div></span><span style="white-space:pre;"><div style="position:absolute;top:658.23pt;left:134.81pt;z-index:2347;letter-spacing:.001em;">=</div></span><span class="fmt-12" style="white-space:pre;"><div style="position:absolute;top:658.23pt;left:142.5pt;z-index:2367;">∑</div></span><span class="fmt-14" style="white-space:pre;"><div style="position:absolute;top:671.73pt;left:144.24pt;z-index:2368;">σ</div></span><span class="fmt-15" style="white-space:pre;"><div style="position:absolute;top:658.98pt;left:151.48pt;z-index:2369;letter-spacing:.001em;">P</div></span><span class="fmt-15" style="white-space:pre;"><div style="position:absolute;top:658.98pt;left:159.86pt;z-index:2361;">r</div></span><span class="fmt-12" style="white-space:pre;"><div style="position:absolute;top:658.98pt;left:164.23pt;z-index:2362;">[</div></span><span class="fmt-12" style="white-space:pre;"><div style="position:absolute;top:658.98pt;left:167.98pt;z-index:2363;">ξ</div></span><span class="fmt-12" style="white-space:pre;"><div style="position:absolute;top:658.98pt;left:173pt;z-index:2364;">σ</div></span><span class="fmt-12" style="white-space:pre;"><div style="position:absolute;top:658.98pt;left:179.06pt;z-index:2365;">]</div></span><span class="fmt-15" style="white-space:pre;"><div style="position:absolute;top:658.98pt;left:182.81pt;z-index:2366;letter-spacing:.001em;">E</div></span><span class="fmt-23" style="white-space:pre;"><div style="position:absolute;top:648.44pt;left:191.18pt;z-index:2374;">[</div></span><span class="fmt-12" style="white-space:pre;"><div style="position:absolute;top:658.23pt;left:200.54pt;z-index:2375;">∑</div></span><span class="fmt-22" style="white-space:pre;"><div style="position:absolute;top:671.73pt;left:203.03pt;z-index:2376;">i</div></span><span class="fmt-15" style="white-space:pre;"><div style="position:absolute;top:658.98pt;left:209.72pt;z-index:2377;">Y</div></span><span class="fmt-15" style="white-space:pre;"><div style="position:absolute;top:658.98pt;left:218.23pt;z-index:2370;">i</div></span><span class="fmt-12" style="white-space:pre;"><div style="position:absolute;top:658.98pt;left:221.35pt;z-index:2371;">|</div></span><span class="fmt-12" style="white-space:pre;"><div style="position:absolute;top:658.98pt;left:223.61pt;z-index:2372;">ξ</div></span><span class="fmt-12" style="white-space:pre;"><div style="position:absolute;top:658.98pt;left:228.62pt;z-index:2373;">σ</div></span><span class="fmt-23" style="white-space:pre;"><div style="position:absolute;top:648.44pt;left:234.68pt;z-index:2378;">]</div></span></div>
      </div>
      <script type="text/javascript">DrawPage7();</script>
      <div style="width:100%">
        <hr />
        <table style="border:0;width:100%;">
          <tbody>
            <tr>
              <td bgcolor="eeeeee" align="right">
                <font face="arial,sans-serif">
                  <b>Page 8</b>
                </font>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <div style="position:relative;width:612pt;height:792pt;">
        <div style="position:absolute;left:0pt;top:0pt;width:100%;height:100%;clip:rect(0pt,612pt,792pt,0pt);" class="fmt-1"><span style="white-space:pre;"><div style="position:absolute;top:80.7263pt;left:144pt;z-index:20;letter-spacing:.021em;">≤ <span class="fmt-12" style="position:relative;left:0pt;top:-1pt;">∑</span><span class="fmt-15">P</span><span class="fmt-15">r</span><span class="fmt-12">[</span> <span class="fmt-12">ξ</span><span class="fmt-12">σ</span>].c<span class="fmt-4" style="position:relative;left:0pt;top:3pt;">1</span>X(σ)</div></span><span class="fmt-14" style="white-space:pre;"><div style="position:absolute;top:93.4834pt;left:156.24pt;z-index:17;">σ</div></span><span style="white-space:pre;"><div style="position:absolute;top:127.23pt;left:144pt;z-index:47;letter-spacing:.026em;">=c<span class="fmt-4" style="position:relative;left:0pt;top:3pt;">1</span><span class="fmt-12" style="position:relative;left:0pt;top:-1pt;">∑</span><span class="fmt-15">E</span><span class="fmt-12">[</span><span class="fmt-15">X</span><span class="fmt-12">|</span> <span class="fmt-12">ξ</span><span class="fmt-12">σ</span>].Pr[<span class="fmt-12">ξ</span><span class="fmt-12">σ</span>]=c<span class="fmt-4" style="position:relative;left:0pt;top:3pt;">1</span>E[X].</div></span><span class="fmt-14" style="white-space:pre;"><div style="position:absolute;top:139.98pt;left:162.24pt;z-index:42;">σ</div></span><span style="white-space:pre;"><div style="position:absolute;top:196.23pt;left:72pt;z-index:132;letter-spacing:-.009em;">Since we know that E [X] is at most c<span class="fmt-4" style="position:relative;left:0pt;top:3pt;">0</span>n, the total expected number of points considered is at most c<span class="fmt-4" style="position:relative;left:0pt;top:3pt;">0</span>c<span class="fmt-4" style="position:relative;left:0pt;top:3pt;">1</span>n=</div></span><span style="white-space:pre;"><div style="position:absolute;top:211.23pt;left:72pt;z-index:157;letter-spacing:-.011em;">O(n), which proves the claim.</div></span><span style="white-space:pre;"><div style="position:absolute;top:241.23pt;left:72pt;z-index:241;letter-spacing:.016em;">Armed with this claim, we can use the universal hash functions from Section 13.6 in our closest­pair</div></span><span style="white-space:pre;"><div style="position:absolute;top:256.23pt;left:72pt;z-index:331;letter-spacing:-.002em;">algorithm. In expectation, the algorithm will consider O(n) points during the <span class="fmt-3">L</span><span class="fmt-3">o</span><span class="fmt-3">o</span><span class="fmt-3">k</span><span class="fmt-3">u</span><span class="fmt-3">p</span> operations. We have</div></span><span style="white-space:pre;"><div style="position:absolute;top:271.23pt;left:72pt;z-index:411;letter-spacing:.018em;">to set up multiple hash tables­­a new one each time the minimum distance changes­­and we have to</div></span><span style="white-space:pre;"><div style="position:absolute;top:286.23pt;left:72pt;z-index:493;">compute O(n) hash­function values. All hash tables are set up for the same size, a prime p ≥ n. We can</div></span><span style="white-space:pre;"><div style="position:absolute;top:301.23pt;left:72pt;z-index:580;letter-spacing:-.002em;">select one prime and use the same table throughout the algorithm. Using this, we get the following bound</div></span><span style="white-space:pre;"><div style="position:absolute;top:316.23pt;left:72pt;z-index:597;letter-spacing:-.012em;">on the running time.</div></span><span class="fmt-3" style="white-space:pre;"><div style="position:absolute;top:346.23pt;left:72pt;z-index:680;letter-spacing:.009em;"><span class="fmt-11">(</span><span class="fmt-11">1</span><span class="fmt-11">3</span><span class="fmt-11">.</span><span class="fmt-11">3</span><span class="fmt-11">3</span><span class="fmt-11">)</span> In expectation, the algorithm uses O(n) hash­function computations and O(n) additional</div></span><span class="fmt-3" style="white-space:pre;"><div style="position:absolute;top:361.23pt;left:72pt;z-index:717;letter-spacing:-.013em;">time for finding the closest pair of points.</div></span><span style="white-space:pre;"><div style="position:absolute;top:391.23pt;left:72pt;z-index:806;letter-spacing:-.005em;">Note the distinction between this statement and (13.31). There we counted each dictionary operation as a</div></span><span style="white-space:pre;"><div style="position:absolute;top:406.23pt;left:72pt;z-index:897;letter-spacing:-.007em;">single, atomic step; here,, on the other hand, we’ve conceptually opened up the dictionary operations so as</div></span><span style="white-space:pre;"><div style="position:absolute;top:421.23pt;left:72pt;z-index:978;letter-spacing:-.01em;">to account for the time incurred due to hash­table collisions and hash­function computations.</div></span><span style="white-space:pre;"><div style="position:absolute;top:451.23pt;left:72pt;z-index:1066;">Finally, consider the time needed for the O(n) hash­function computations. How fast is it to compute the</div></span><span style="white-space:pre;"><div style="position:absolute;top:466.23pt;left:72pt;z-index:1151;letter-spacing:.014em;">value of a universal hash function <span class="fmt-3">h</span>? The class of universal hash functions developed in Section 13.6</div></span><span style="white-space:pre;"><div style="position:absolute;top:481.23pt;left:72pt;z-index:1228;letter-spacing:-.016em;">breaks numbers in our universe U into r ≈ log N/log n smaller numbers of size O(log n) each, and</div></span><span style="white-space:pre;"><div style="position:absolute;top:496.23pt;left:72pt;z-index:1314;letter-spacing:.01em;">then uses O(r) arithmetic operations on these smaller numbers to compute the hash­function value. $o</div></span><span style="white-space:pre;"><div style="position:absolute;top:511.23pt;left:72pt;z-index:1405;letter-spacing:-.01em;">computing the hash value of a single point involves O(log N/log n) multiplications, on numbers of size log n.</div></span><span style="white-space:pre;"><div style="position:absolute;top:526.23pt;left:72pt;z-index:1484;letter-spacing:-.014em;">This is a total of O(n log N/log n) arithmetic operations over the course of the algorithm, more</div></span><span style="white-space:pre;"><div style="position:absolute;top:541.23pt;left:72pt;z-index:1511;letter-spacing:-.015em;">than the O(n) we were hoping for.</div></span><span style="white-space:pre;"><div style="position:absolute;top:571.23pt;left:72pt;z-index:1602;letter-spacing:-.01em;">In fact, it is possible to decrease the number of arithmetic operations to O(n) by using a more sophisticated</div></span><span style="white-space:pre;"><div style="position:absolute;top:586.23pt;left:72pt;z-index:1684;letter-spacing:-.015em;">class  of  hash  functions.  There  are  other  classes  of  universal  hash  functions  where  computing  the</div></span><span style="white-space:pre;"><div style="position:absolute;top:601.23pt;left:72pt;z-index:1773;letter-spacing:-.001em;">hash­function value can be done by only O(1) arithmetic operations (though these operations will have to</div></span><span style="white-space:pre;"><div style="position:absolute;top:616.23pt;left:72pt;z-index:1858;letter-spacing:.009em;">be done on larger numbers, integers of size roughly log N). This class of improved hash functions also</div></span><span style="white-space:pre;"><div style="position:absolute;top:631.23pt;left:72pt;z-index:1947;">comes with one extra difficulty for this application: the hashing scheme needs a prime that is bigger than</div></span><span style="white-space:pre;"><div style="position:absolute;top:646.23pt;left:72pt;z-index:2038;letter-spacing:-.006em;">the size of the universe (rather than just the size of the set of points). Now the universe in this application</div></span><span style="white-space:pre;"><div style="position:absolute;top:661.23pt;left:72pt;z-index:2126;letter-spacing:-.008em;">grows inversely with the minimum distance  σ , and so, in particular, it increases every time we discover a</div></span><span style="white-space:pre;"><div style="position:absolute;top:676.23pt;left:72pt;z-index:2207;letter-spacing:-.003em;">new, smaller minimum distance. At such points, we will have to find a new prime and set up a new hash</div></span><span style="white-space:pre;"><div style="position:absolute;top:691.23pt;left:72pt;z-index:2299;letter-spacing:-.001em;">table. Although we will not go into the details of this here, it is possible to deal with these difficulties and</div></span><canvas id="_canv_31" style="position:absolute;left:0pt;top:0pt;width:612pt;height:792pt;z-index:1;" width="816" height="1056">Your browser does not support the canvas tag!</canvas><canvas id="_canv_32" style="position:absolute;left:0pt;top:-5544pt;width:612pt;height:7920pt;z-index:2;" width="816" height="10560">Your browser does not support the canvas tag!</canvas><canvas id="_canv_33" style="position:absolute;left:0pt;top:0pt;width:612pt;height:792pt;z-index:3;" width="816" height="1056">Your browser does not support the canvas tag!</canvas><canvas id="_canv_34" style="position:absolute;left:0pt;top:72pt;width:612pt;height:720pt;z-index:4;" width="816" height="960">Your browser does not support the canvas tag!</canvas><span style="white-space:pre;"><div style="position:absolute;top:706.23pt;left:72pt;z-index:2350;letter-spacing:-.012em;">make the algorithm achieve an expected running time of O(n).</div></span></div>
      </div>
      <script type="text/javascript">DrawPage8();</script>
      <div style="width:100%">
        <hr />
        <table style="border:0;width:100%;">
          <tbody>
            <tr>
              <td bgcolor="eeeeee" align="right">
                <font face="arial,sans-serif">
                  <b>Page 9</b>
                </font>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <div style="position:relative;width:612pt;height:792pt;">
        <div style="position:absolute;left:0pt;top:0pt;width:100%;height:100%;clip:rect(0pt,612pt,792pt,0pt);">
          <canvas id="_canv_35" style="position:absolute;left:0pt;top:0pt;width:612pt;height:792pt;z-index:1;" width="816" height="1056">Your browser does not support the canvas tag!</canvas>
          <canvas id="_canv_36" style="position:absolute;left:0pt;top:-6336pt;width:612pt;height:7920pt;z-index:2;" width="816" height="10560">Your browser does not support the canvas tag!</canvas>
          <canvas id="_canv_37" style="position:absolute;left:0pt;top:0pt;width:612pt;height:792pt;z-index:3;" width="816" height="1056">Your browser does not support the canvas tag!</canvas>
          <canvas id="_canv_38" style="position:absolute;left:0pt;top:72pt;width:612pt;height:720pt;z-index:4;" width="816" height="960">Your browser does not support the canvas tag!</canvas>
        </div>
      </div>
      <script type="text/javascript">DrawPage9();</script>
      <div style="width:100%">
        <hr />
        <table style="border:0;width:100%;">
          <tbody>
            <tr>
              <td bgcolor="eeeeee" align="right">
                <font face="arial,sans-serif">
                  <b>Page 10</b>
                </font>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <div style="position:relative;width:612pt;height:792pt;">
        <div style="position:absolute;left:0pt;top:0pt;width:100%;height:100%;clip:rect(0pt,612pt,792pt,0pt);">
          <canvas id="_canv_39" style="position:absolute;left:0pt;top:0pt;width:612pt;height:792pt;z-index:1;" width="816" height="1056">Your browser does not support the canvas tag!</canvas>
          <canvas id="_canv_40" style="position:absolute;left:0pt;top:-7128pt;width:612pt;height:7920pt;z-index:2;" width="816" height="10560">Your browser does not support the canvas tag!</canvas>
          <canvas id="_canv_41" style="position:absolute;left:0pt;top:0pt;width:612pt;height:792pt;z-index:3;" width="816" height="1056">Your browser does not support the canvas tag!</canvas>
          <canvas id="_canv_42" style="position:absolute;left:0pt;top:72pt;width:612pt;height:720pt;z-index:4;" width="816" height="960">Your browser does not support the canvas tag!</canvas>
        </div>
      </div>
      <script type="text/javascript">DrawPage10();</script>
    </div>
  </body>
</html>
